import getStandardForm from "../../../utility/-getStandardForm";
var Circuit;
(function (Circuit) {
    var Component;
    (function (Component) {
        var _Bipolar;
        (function (_Bipolar) {
            function drawSchematic(instance) {
                const bodyGroup = Svg.Element.Group.make("body");
                const emitterEnd = instance.joints[INDEXEMITTER];
                const collectorEnd = instance.joints[INDEXCOLLECTOR];
                const baseEnd = instance.joints[INDEXBASE];
                const arrowJoints = (instance.type === "PNP")
                    ? [{ x: 15, y: -18 }, { x: 9, y: -7.5 }, { x: 24, y: -5.5 }, { x: 15, y: -18 }]
                    : [{ x: 9, y: -7.5 }, { x: 15, y: -18 }, { x: 0, y: -20 }, { x: 9, y: -7.5 }];
                bodyGroup.append(Svg.Element.Circle.make({ x: 10, y: 0 }, 30, "extrathick highlight"), Svg.Element.Line.make({ x: 25, y: -15 }, { x: 25, y: +15 }, "line medium-thick nocap"), Svg.Element.Line.make({ x: 25, y: -5 }, { x: 0, y: -20 }, "line thin"), Svg.Element.Line.make({ x: 25, y: 5 }, { x: 0, y: 20 }, "line thin"), Svg.Element.Line.make({ x: 25, y: 0 }, { x: 40, y: 0 }, "line thin"), Svg.Element.Line.make({ x: 0, y: -20 }, { x: 0, y: -28 }, "line thin"), Svg.Element.Line.make({ x: 0, y: 20 }, { x: 0, y: 28 }, "line thin"), Svg.Element.Path.make(arrowJoints, "body black thin"), Svg.Element.Circle.make({ x: 10, y: 0 }, 30, "line medium nofill"));
                const centre = vector(emitterEnd, collectorEnd).centre().vector;
                const angleCentreBase = vector(centre).getAngleTo(baseEnd);
                const angleEmitterCollector = vector(emitterEnd).getAngleTo(collectorEnd);
                const rotation = angleEmitterCollector - 90;
                const scale = (((angleEmitterCollector - angleCentreBase + 360) % 360) > 180)
                    ? { x: -1 }
                    : { x: 1 };
                const [emitterStart, collectorStart, baseStart] = vector({ x: 0, y: -28 }, { x: 0, y: 28 }, { x: 40, y: 0 }).scaleWith(scale).rotate(rotation).sumWith(centre).vectors;
                const joints = [
                    [emitterStart, emitterEnd],
                    [collectorStart, collectorEnd],
                    [baseStart, baseEnd],
                ];
                const text = getStandardForm(instance.currentGain, '');
                const textEl = Svg.Element.Text.make(text, vector({ x: -40, y: 0 }).scaleWith(scale), "text");
                return [
                    bodyGroup.translate(centre).rotate(rotation).scale(scale, false),
                    Svg.Element.Path.make(joints, "line thin"),
                    textEl.translate(centre).rotatePosition(rotation),
                ];
            }
            _Bipolar.drawSchematic = drawSchematic;
        })(_Bipolar = Component._Bipolar || (Component._Bipolar = {}));
    })(Component = Circuit.Component || (Circuit.Component = {}));
})(Circuit || (Circuit = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLWRyYXdTY2hlbWF0aWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi90eXBlc2NyaXB0L2NpcmN1aXQvY29tcG9uZW50L19iaXBvbGFyLy1kcmF3U2NoZW1hdGljLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sZUFBZSxNQUFNLG1DQUFtQyxDQUFDO0FBQ2hFLElBQVUsT0FBTyxDQStFaEI7QUEvRUQsV0FBVSxPQUFPO0lBQUMsSUFBQSxTQUFTLENBK0UxQjtJQS9FaUIsV0FBQSxTQUFTO1FBQUMsSUFBQSxRQUFRLENBK0VuQztRQS9FMkIsV0FBQSxRQUFRO1lBQ2pDLFNBQWdCLGFBQWEsQ0FBQyxRQUF3QjtnQkFDbkQsTUFBTSxTQUFTLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUVqRCxNQUFNLFVBQVUsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDO2dCQUNqRCxNQUFNLFlBQVksR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDO2dCQUNyRCxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUkzQyxNQUFNLFdBQVcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEtBQUssS0FBSyxDQUFDO29CQUMxQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7b0JBQy9FLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO2dCQU1qRixTQUFTLENBQUMsTUFBTSxDQUViLEdBQUcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxzQkFBc0IsQ0FBQyxFQUVwRSxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSx5QkFBeUIsQ0FBQyxFQUV0RixHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxXQUFXLENBQUMsRUFFdEUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxXQUFXLENBQUMsRUFFcEUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMs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QkFDSixTQUFTLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQztvQkFDaEUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxXQUFXLENBQUM7b0JBQzFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQztpQkFDbkQsQ0FBQztZQUNMLENBQUM7WUE3RWUsc0JBQWEsZ0JBNkU1QixDQUFBO1FBQ0osQ0FBQyxFQS9FMkIsUUFBUSxHQUFSLGtCQUFRLEtBQVIsa0JBQVEsUUErRW5DO0lBQUQsQ0FBQyxFQS9FaUIsU0FBUyxHQUFULGlCQUFTLEtBQVQsaUJBQVMsUUErRTFCO0FBQUQsQ0FBQyxFQS9FUyxPQUFPLEtBQVAsT0FBTyxRQStFaEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZ2V0U3RhbmRhcmRGb3JtIGZyb20gXCIuLi8uLi8uLi91dGlsaXR5Ly1nZXRTdGFuZGFyZEZvcm1cIjtcclxubmFtZXNwYWNlIENpcmN1aXQuQ29tcG9uZW50Ll9CaXBvbGFyIHtcclxuICAgZXhwb3J0IGZ1bmN0aW9uIGRyYXdTY2hlbWF0aWMoaW5zdGFuY2U6IENsYXNzZXMuTGF5b3V0KSB7XHJcbiAgICAgIGNvbnN0IGJvZHlHcm91cCA9IFN2Zy5FbGVtZW50Lkdyb3VwLm1ha2UoXCJib2R5XCIpO1xyXG5cclxuICAgICAgY29uc3QgZW1pdHRlckVuZCA9IGluc3RhbmNlLmpvaW50c1tJTkRFWEVNSVRURVJdO1xyXG4gICAgICBjb25zdCBjb2xsZWN0b3JFbmQgPSBpbnN0YW5jZS5qb2ludHNbSU5ERVhDT0xMRUNUT1JdO1xyXG4gICAgICBjb25zdCBiYXNlRW5kID0gaW5zdGFuY2Uuam9pbnRzW0lOREVYQkFTRV07XHJcblxyXG4gICAgICAvLyBTYW1lIGFzIHZlY3RvcihbeyB4OiA3LCB5OiA2IH0sIHsgeDogNywgeTogLTYgfSwgeyB4OiAtNywgeTogMCB9LCB7IHg6IDcsIHk6IDYgfV0pXHJcbiAgICAgIC8vICAgIC5yb3RhdGUoMTQ5IHwgLTMxKS5zdW1XaXRoKHsgeDogMTgsIHk6IC05LjIgfSB8IHsgeDogNiwgeTogLTE2LjQgfSlcclxuICAgICAgY29uc3QgYXJyb3dKb2ludHMgPSAoaW5zdGFuY2UudHlwZSA9PT0gXCJQTlBcIilcclxuICAgICAgICAgPyBbeyB4OiAxNSwgeTogLTE4IH0sIHsgeDogOSwgeTogLTcuNSB9LCB7IHg6IDI0LCB5OiAtNS41IH0sIHsgeDogMTUsIHk6IC0xOCB9XVxyXG4gICAgICAgICA6IFt7IHg6IDksIHk6IC03LjUgfSwgeyB4OiAxNSwgeTogLTE4IH0sIHsgeDogMCwgeTogLTIwIH0sIHsgeDogOSwgeTogLTcuNSB9XTtcclxuXHJcbiAgICAgIC8vIFRoZSBkcmF3aW5ncyBvcmllbnRhdGlvbiAoYmVmb3JlIHRyYW5zZm9ybXMpIGlzOiBcclxuICAgICAgLy8gICBlbWl0dGVyIGF0IHRoZSB0b3BcclxuICAgICAgLy8gICBjb2xsZWN0b3IgYXQgdGhlIGJvdHRvbVxyXG4gICAgICAvLyAgIGJhc2UgdG8gdGhlIHJpZ2h0XHJcbiAgICAgIGJvZHlHcm91cC5hcHBlbmQoXHJcbiAgICAgICAgIC8vSGlnaGxpZ2h0XHJcbiAgICAgICAgIFN2Zy5FbGVtZW50LkNpcmNsZS5tYWtlKHsgeDogMTAsIHk6IDAgfSwgMzAsIFwiZXh0cmF0aGljayBoaWdobGlnaHRcIiksXHJcbiAgICAgICAgIC8vQmFzZSBWZXJ0aWNhbCBCYXJcclxuICAgICAgICAgU3ZnLkVsZW1lbnQuTGluZS5tYWtlKHsgeDogMjUsIHk6IC0xNSB9LCB7IHg6IDI1LCB5OiArMTUgfSwgXCJsaW5lIG1lZGl1bS10aGljayBub2NhcFwiKSxcclxuICAgICAgICAgLy9Db2xsZWN0b3IgQW5nbGVkIExpbmVcclxuICAgICAgICAgU3ZnLkVsZW1lbnQuTGluZS5tYWtlKHsgeDogMjUsIHk6IC01IH0sIHsgeDogMCwgeTogLTIwIH0sIFwibGluZSB0aGluXCIpLFxyXG4gICAgICAgICAvL0VtaXR0ZXIgQW5nbGVkIExpbmVcclxuICAgICAgICAgU3ZnLkVsZW1lbnQuTGluZS5tYWtlKHsgeDogMjUsIHk6IDUgfSwgeyB4OiAwLCB5OiAyMCB9LCBcImxpbmUgdGhpblwiKSxcclxuICAgICAgICAgLy9CYXNlIEhvcml6b250YWwgTGluZSB0byBjaXJjbGVcclxuICAgICAgICAgU3ZnLkVsZW1lbnQuTGluZS5tYWtlKHsgeDogMjUsIHk6IDAgfSwgeyB4OiA0MCwgeTogMCB9LCBcImxpbmUgdGhpblwiKSxcclxuICAgICAgICAgLy9Db2xsZWN0b3IgVmVydGljYWwgTGluZSB0byBjaXJjbGVcclxuICAgICAgICAgU3ZnLkVsZW1lbnQuTGluZS5tYWtlKHsgeDogMCwgeTogLTIwIH0sIHsgeDogMCwgeTogLTI4IH0sIFwibGluZSB0aGluXCIpLFxyXG4gICAgICAgICAvL0VtaXR0ZXIgVmVydGljYWwgTGluZSB0byBjaXJjbGVcclxuICAgICAgICAgU3ZnLkVsZW1lbnQuTGluZS5tYWtlKHsgeDogMCwgeTogMjAgfSwgeyB4OiAwLCB5OiAyOCB9LCBcImxpbmUgdGhpblwiKSxcclxuICAgICAgICAgLy9BcnJvd1xyXG4gICAgICAgICBTdmcuRWxlbWVudC5QYXRoLm1ha2UoYXJyb3dKb2ludHMsIFwiYm9keSBibGFjayB0aGluXCIpLFxyXG4gICAgICAgICAvL0NpcmNsZVxyXG4gICAgICAgICBTdmcuRWxlbWVudC5DaXJjbGUubWFrZSh7IHg6IDEwLCB5OiAwIH0sIDMwLCBcImxpbmUgbWVkaXVtIG5vZmlsbFwiKVxyXG4gICAgICApO1xyXG5cclxuXHJcbiAgICAgIC8vIEltYWdlIGNlbnRyZSBkb2VzIG5vdCB0YWtlIGJhc2UgaW50byBhY2NvdW50XHJcbiAgICAgIC8vIElzIGFsd2F5cyBkaXJlY3RseSBiZXR3ZWVuIHRoZSBlbWl0dGVyIGFuZCBjb2xsZWN0b3JcclxuICAgICAgY29uc3QgY2VudHJlID0gdmVjdG9yKGVtaXR0ZXJFbmQsIGNvbGxlY3RvckVuZCkuY2VudHJlKCkudmVjdG9yO1xyXG5cclxuICAgICAgLy8gYWxsIGFuZ2xlcyBhcmUgcmVsYXRpdmUgdG8gdGhlIHgtYXhpcywgaGVuY2UgaW4gZGVmYXVsdCBvcmllbnRhdGlvbjpcclxuICAgICAgLy8gICB3aGVuIG5vIHJvdGF0aW9uIGlzIHJlcXVpcmVkLCBhbmdsZUVtaXR0ZXJDZW50cmUgPSA5MCwgXHJcbiAgICAgIGNvbnN0IGFuZ2xlQ2VudHJlQmFzZSA9IHZlY3RvcihjZW50cmUpLmdldEFuZ2xlVG8oYmFzZUVuZCk7XHJcbiAgICAgIGNvbnN0IGFuZ2xlRW1pdHRlckNvbGxlY3RvciA9IHZlY3RvcihlbWl0dGVyRW5kKS5nZXRBbmdsZVRvKGNvbGxlY3RvckVuZCk7XHJcblxyXG4gICAgICBjb25zdCByb3RhdGlvbiA9IGFuZ2xlRW1pdHRlckNvbGxlY3RvciAtIDkwO1xyXG5cclxuICAgICAgLy8gRG9uJ3QgYXNrLlxyXG4gICAgICBjb25zdCBzY2FsZSA9ICgoKGFuZ2xlRW1pdHRlckNvbGxlY3RvciAtIGFuZ2xlQ2VudHJlQmFzZSArIDM2MCkgJSAzNjApID4gMTgwKVxyXG4gICAgICAgICA/IHsgeDogLTEgfVxyXG4gICAgICAgICA6IHsgeDogMSB9O1xyXG5cclxuICAgICAgLy8gT25seSB0aGUgc3RhcnQgb2YgdGhlIGNvbm5lY3Rpb25zIHNob3VsZCBiZSB0cmFuc2Zvcm1lZCwgXHJcbiAgICAgIC8vIHRoZSBlbmRzIHNob3VsZCBiZSBhYnNvbHV0ZS5cclxuICAgICAgLy8gKEhlbmNlIHVzaW5nIHZlY3RvciB0cmFuc2Zvcm1zLCBub3Qgc3ZnIHRyYW5zZm9ybXMpXHJcbiAgICAgIGNvbnN0IFtlbWl0dGVyU3RhcnQsIGNvbGxlY3RvclN0YXJ0LCBiYXNlU3RhcnRdOiBWZWN0b3JbXSA9IHZlY3RvcihcclxuICAgICAgICAgeyB4OiAwLCB5OiAtMjggfSwgeyB4OiAwLCB5OiAyOCB9LCB7IHg6IDQwLCB5OiAwIH1cclxuICAgICAgKS5zY2FsZVdpdGgoc2NhbGUpLnJvdGF0ZShyb3RhdGlvbikuc3VtV2l0aChjZW50cmUpLnZlY3RvcnM7XHJcblxyXG5cclxuICAgICAgY29uc3Qgam9pbnRzID0gW1xyXG4gICAgICAgICBbZW1pdHRlclN0YXJ0LCBlbWl0dGVyRW5kXSxcclxuICAgICAgICAgW2NvbGxlY3RvclN0YXJ0LCBjb2xsZWN0b3JFbmRdLFxyXG4gICAgICAgICBbYmFzZVN0YXJ0LCBiYXNlRW5kXSxcclxuICAgICAgXVxyXG5cclxuICAgICAgY29uc3QgdGV4dCA9IGdldFN0YW5kYXJkRm9ybShpbnN0YW5jZS5jdXJyZW50R2FpbiwgJycpXHJcbiAgICAgIGNvbnN0IHRleHRFbCA9IFN2Zy5FbGVtZW50LlRleHQubWFrZSh0ZXh0LCB2ZWN0b3IoeyB4OiAtNDAsIHk6IDAgfSkuc2NhbGVXaXRoKHNjYWxlKSwgXCJ0ZXh0XCIpO1xyXG5cclxuICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgYm9keUdyb3VwLnRyYW5zbGF0ZShjZW50cmUpLnJvdGF0ZShyb3RhdGlvbikuc2NhbGUoc2NhbGUsIGZhbHNlKSxcclxuICAgICAgICAgU3ZnLkVsZW1lbnQuUGF0aC5tYWtlKGpvaW50cywgXCJsaW5lIHRoaW5cIiksXHJcbiAgICAgICAgIHRleHRFbC50cmFuc2xhdGUoY2VudHJlKS5yb3RhdGVQb3NpdGlvbihyb3RhdGlvbiksXHJcbiAgICAgIF07XHJcbiAgIH1cclxufVxyXG4iXX0=