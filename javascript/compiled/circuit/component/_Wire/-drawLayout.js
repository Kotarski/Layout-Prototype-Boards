"use strict";
var Circuit;
(function (Circuit) {
    var Component;
    (function (Component) {
        var _Wire;
        (function (_Wire) {
            function drawLayout(instance) {
                const bodyGroup = Svg.Element.Group.make("body");
                const joints = instance.joints;
                let coverPath, leadPath = "";
                let coverRatio = 0.6;
                coverPath = leadPath = "M " + joints[0].x + " " + joints[0].y;
                coverPath += getSegmentTowardsJointMid(joints[0], joints[1], -coverRatio);
                leadPath += getSegmentTowardsJointMid(joints[0], joints[1], 1);
                let pathMid = getBezierBetweenJoints(joints);
                coverPath += pathMid;
                leadPath += pathMid;
                coverPath += getSegmentTowardsJointMid(joints[joints.length - 2], joints[joints.length - 1], coverRatio);
                leadPath += getSegmentTowardsJointMid(joints[joints.length - 2], joints[joints.length - 1], 1);
                let cover = Svg.Element.Path.make(coverPath, "cover");
                $(cover.element).css("stroke", instance.color);
                bodyGroup.append(Svg.Element.Path.make(leadPath, "lead"), Svg.Element.Path.make(coverPath, "leadhighlight highlight"), cover);
                return bodyGroup;
            }
            _Wire.drawLayout = drawLayout;
            function getBezierBetweenJoints(joints) {
                let path = "";
                for (let j = 1; j < joints.length - 1; j++) {
                    let p3 = {
                        x: (joints[j + 1].x + joints[j].x) / 2,
                        y: (joints[j + 1].y + joints[j].y) / 2
                    };
                    path += "Q " + joints[j].x + " " + joints[j].y +
                        " " + p3.x + " " + p3.y;
                }
                return path;
            }
            function getSegmentTowardsJointMid(j0, j1, ratio) {
                let changeMid = {
                    x: (j1.x - j0.x) / 2,
                    y: (j1.y - j0.y) / 2
                };
                if (Math.sign(ratio) >= 0) {
                    return 'l' + (changeMid.x * ratio) + " " + (changeMid.y * ratio) +
                        'm' + (changeMid.x * (1 - ratio)) + " " + (changeMid.y * (1 - ratio));
                }
                else {
                    ratio = Math.abs(ratio);
                    return 'm' + (changeMid.x * (1 - ratio)) + " " + (changeMid.y * (1 - ratio)) +
                        'l' + (changeMid.x * ratio) + " " + (changeMid.y * ratio);
                }
            }
        })(_Wire = Component._Wire || (Component._Wire = {}));
    })(Component = Circuit.Component || (Circuit.Component = {}));
})(Circuit || (Circuit = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLWRyYXdMYXlvdXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi90eXBlc2NyaXB0L2NpcmN1aXQvY29tcG9uZW50L193aXJlLy1kcmF3TGF5b3V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFVLE9BQU8sQ0ErRWhCO0FBL0VELFdBQVUsT0FBTztJQUFDLElBQUEsU0FBUyxDQStFMUI7SUEvRWlCLFdBQUEsU0FBUztRQUFDLElBQUEsS0FBSyxDQStFaEM7UUEvRTJCLFdBQUEsS0FBSztZQUM5QixTQUFnQixVQUFVLENBQUMsUUFBd0I7Z0JBQ2hELE1BQU0sU0FBUyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFFakQsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQztnQkFFL0IsSUFBSSxTQUFTLEVBQUUsUUFBUSxHQUFXLEVBQUUsQ0FBQztnQkFHckMsSUFBSSxVQUFVLEdBQUcsR0FBRyxDQUFDO2dCQUdyQixTQUFTLEdBQUcsUUFBUSxHQUFHLElBQUksR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUc5RCxTQUFTLElBQUkseUJBQXlCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDO2dCQUUxRSxRQUFRLElBQUkseUJBQXlCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFHL0QsSUFBSSxPQUFPLEdBQUcsc0JBQXNCLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQzdDLFNBQVMsSUFBSSxPQUFPLENBQUM7Z0JBQ3JCLFFBQVEsSUFBSSxPQUFP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QUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQztpQkFDM0U7cUJBQU07b0JBQ0osS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQ3hCLE9BQU8sR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUM7d0JBQ3pFLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztpQkFDL0Q7WUFDSixDQUFDO1FBQ0osQ0FBQyxFQS9FMkIsS0FBSyxHQUFMLGVBQUssS0FBTCxlQUFLLFFBK0VoQztJQUFELENBQUMsRUEvRWlCLFNBQVMsR0FBVCxpQkFBUyxLQUFULGlCQUFTLFFBK0UxQjtBQUFELENBQUMsRUEvRVMsT0FBTyxLQUFQLE9BQU8sUUErRWhCIiwic291cmNlc0NvbnRlbnQiOlsibmFtZXNwYWNlIENpcmN1aXQuQ29tcG9uZW50Ll9XaXJlIHtcclxuICAgZXhwb3J0IGZ1bmN0aW9uIGRyYXdMYXlvdXQoaW5zdGFuY2U6IENsYXNzZXMuTGF5b3V0KSB7XHJcbiAgICAgIGNvbnN0IGJvZHlHcm91cCA9IFN2Zy5FbGVtZW50Lkdyb3VwLm1ha2UoXCJib2R5XCIpO1xyXG5cclxuICAgICAgY29uc3Qgam9pbnRzID0gaW5zdGFuY2Uuam9pbnRzO1xyXG5cclxuICAgICAgbGV0IGNvdmVyUGF0aCwgbGVhZFBhdGg6IHN0cmluZyA9IFwiXCI7XHJcblxyXG4gICAgICAvL1RoZSBwcm9wb3J0aW9uIG9mIGhhbGYgdGhlIGVuZCBqb2ludHMgdGhhdCBpcyBjb3ZlciBub3QgbGVhZFxyXG4gICAgICBsZXQgY292ZXJSYXRpbyA9IDAuNjsgLy9CRVRXRUVOIDAgYW5kIDFcclxuXHJcbiAgICAgIC8vU3RhcnQgYXQgdGhlIGJlZ2lubmluZ1xyXG4gICAgICBjb3ZlclBhdGggPSBsZWFkUGF0aCA9IFwiTSBcIiArIGpvaW50c1swXS54ICsgXCIgXCIgKyBqb2ludHNbMF0ueTtcclxuXHJcbiAgICAgIC8vIERyYXcgY292ZXIgdG93YXJkcyB0aGUgbWlkcG9pbnQgb2YgZmlyc3QgdHdvIGpvaW50cyAoc3RhcnRpbmcgZnJvbSBjb3ZlclJhdGlvKVxyXG4gICAgICBjb3ZlclBhdGggKz0gZ2V0U2VnbWVudFRvd2FyZHNKb2ludE1pZChqb2ludHNbMF0sIGpvaW50c1sxXSwgLWNvdmVyUmF0aW8pO1xyXG4gICAgICAvLyBEcmF3IGxlYWQgcGF0aCBmcm9tIHN0YXJ0IHRvIG1pZHBvaW50IG9mIHRoZSBmaXJzdCB0d28gam9pbnRzXHJcbiAgICAgIGxlYWRQYXRoICs9IGdldFNlZ21lbnRUb3dhcmRzSm9pbnRNaWQoam9pbnRzWzBdLCBqb2ludHNbMV0sIDEpO1xyXG5cclxuICAgICAgLy8gRHJhdyBjdXJ2ZSBiZXR3ZWVuIGFsbCBtaWQgam9pbnRzXHJcbiAgICAgIGxldCBwYXRoTWlkID0gZ2V0QmV6aWVyQmV0d2VlbkpvaW50cyhqb2ludHMpO1xyXG4gICAgICBjb3ZlclBhdGggKz0gcGF0aE1pZDtcclxuICAgICAgbGVhZFBhdGggKz0gcGF0aE1pZDtcclxuXHJcbiAgICAgIC8vIERyYXcgY292ZXIgYXdheSBmcm9tIHRoZSBtaWRwb2ludCBvZiB0aGUgbGFzdCB0d28gam9pbnRzIChzdGFydGluZyBmcm9tIDEtY292ZXJSYXRpbylcclxuICAgICAgY292ZXJQYXRoICs9IGdldFNlZ21lbnRUb3dhcmRzSm9pbnRNaWQoam9pbnRzW2pvaW50cy5sZW5ndGggLSAyXSwgam9pbnRzW2pvaW50cy5sZW5ndGggLSAxXSwgY292ZXJSYXRpbylcclxuICAgICAgLy8gRHJhdyBsZWFkIHBhdGggdG8gZW5kXHJcbiAgICAgIGxlYWRQYXRoICs9IGdldFNlZ21lbnRUb3dhcmRzSm9pbnRNaWQoam9pbnRzW2pvaW50cy5sZW5ndGggLSAyXSwgam9pbnRzW2pvaW50cy5sZW5ndGggLSAxXSwgMSlcclxuXHJcbiAgICAgIGxldCBjb3ZlciA9IFN2Zy5FbGVtZW50LlBhdGgubWFrZShjb3ZlclBhdGgsIFwiY292ZXJcIik7XHJcblxyXG4gICAgICAkKGNvdmVyLmVsZW1lbnQpLmNzcyhcInN0cm9rZVwiLCBpbnN0YW5jZS5jb2xvcik7XHJcbiAgICAgIC8vU3R5bGUgYW5kIGFkZCBsZWFkLCBjb3ZlclxyXG4gICAgICAvLyhQcmVwZW5kIHNvIGhhbmRsZXMgYXBwZWFyIG9uIHRvcClcclxuXHJcbiAgICAgIGJvZHlHcm91cC5hcHBlbmQoXHJcbiAgICAgICAgIFN2Zy5FbGVtZW50LlBhdGgubWFrZShsZWFkUGF0aCwgXCJsZWFkXCIpLFxyXG4gICAgICAgICBTdmcuRWxlbWVudC5QYXRoLm1ha2UoY292ZXJQYXRoLCBcImxlYWRoaWdobGlnaHQgaGlnaGxpZ2h0XCIpLFxyXG4gICAgICAgICBjb3ZlcixcclxuICAgICAgKTtcclxuXHJcbiAgICAgIHJldHVybiBib2R5R3JvdXA7XHJcbiAgIH1cclxuXHJcbiAgIGZ1bmN0aW9uIGdldEJlemllckJldHdlZW5Kb2ludHMoam9pbnRzOiBWZWN0b3JbXSk6IHN0cmluZyB7XHJcbiAgICAgIC8vQXNzdW1lIHdlIGFyZSBzdGFydGluZyBhdCB0aGUgbWlkcG9pbnQgYmV0d2VlbiBmaXJzdCB0d28gam9pbnRzXHJcbiAgICAgIGxldCBwYXRoOiBzdHJpbmcgPSBcIlwiO1xyXG5cclxuICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCBqb2ludHMubGVuZ3RoIC0gMTsgaisrKSB7XHJcblxyXG4gICAgICAgICAvLyBFbmQgZWFjaCBjdXJ2ZSBhdCB0aGUgbWlkIHBvaW50IGJldHdlZW4gdGhlIGxhc3QgdHdvIGpvaW50c1xyXG4gICAgICAgICBsZXQgcDMgPSB7XHJcbiAgICAgICAgICAgIHg6IChqb2ludHNbaiArIDFdLnggKyBqb2ludHNbal0ueCkgLyAyLFxyXG4gICAgICAgICAgICB5OiAoam9pbnRzW2ogKyAxXS55ICsgam9pbnRzW2pdLnkpIC8gMlxyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICBwYXRoICs9IFwiUSBcIiArIGpvaW50c1tqXS54ICsgXCIgXCIgKyBqb2ludHNbal0ueSArXHJcbiAgICAgICAgICAgIFwiIFwiICsgcDMueCArIFwiIFwiICsgcDMueTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHBhdGg7XHJcbiAgIH1cclxuXHJcbiAgIC8vIFN0YXJ0aW5nIG9yIGVuZGluZyBhdCBhIG1pZHBvaW50XHJcbiAgIGZ1bmN0aW9uIGdldFNlZ21lbnRUb3dhcmRzSm9pbnRNaWQoajA6IFZlY3RvciwgajE6IFZlY3RvciwgcmF0aW86IG51bWJlcik6IHN0cmluZyB7XHJcbiAgICAgIGxldCBjaGFuZ2VNaWQgPSB7XHJcbiAgICAgICAgIHg6IChqMS54IC0gajAueCkgLyAyLFxyXG4gICAgICAgICB5OiAoajEueSAtIGowLnkpIC8gMlxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoTWF0aC5zaWduKHJhdGlvKSA+PSAwKSB7XHJcbiAgICAgICAgIHJldHVybiAnbCcgKyAoY2hhbmdlTWlkLnggKiByYXRpbykgKyBcIiBcIiArIChjaGFuZ2VNaWQueSAqIHJhdGlvKSArXHJcbiAgICAgICAgICAgICdtJyArIChjaGFuZ2VNaWQueCAqICgxIC0gcmF0aW8pKSArIFwiIFwiICsgKGNoYW5nZU1pZC55ICogKDEgLSByYXRpbykpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICByYXRpbyA9IE1hdGguYWJzKHJhdGlvKTtcclxuICAgICAgICAgcmV0dXJuICdtJyArIChjaGFuZ2VNaWQueCAqICgxIC0gcmF0aW8pKSArIFwiIFwiICsgKGNoYW5nZU1pZC55ICogKDEgLSByYXRpbykpICtcclxuICAgICAgICAgICAgJ2wnICsgKGNoYW5nZU1pZC54ICogcmF0aW8pICsgXCIgXCIgKyAoY2hhbmdlTWlkLnkgKiByYXRpbyk7XHJcbiAgICAgIH1cclxuICAgfVxyXG59Il19